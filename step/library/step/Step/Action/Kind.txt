module Step.Action.Kind where

import Bool (Bool (..))

data Advancement = Stationary | Advances | MightAdvance

data Fallibility = MightFail | AlwaysSucceeds

data Commitment = Noncommittal | MightCommitFailure | EitherCannotMoveOrCannotFail

type family CanBeStationary (p :: Advancement) :: Bool

type instance CanBeStationary 'Stationary = 'True
type instance CanBeStationary 'MightAdvance = 'True
type instance CanBeStationary 'Advances = 'False

type family CanAdvance (p :: Advancement) :: Bool

type instance CanAdvance 'Stationary = 'False
type instance CanAdvance 'MightAdvance = 'True
type instance CanAdvance 'Advances = 'True

type family AdvancementOf (p :: ActionKind) :: Advancement

type instance AdvancementOf 'Any = 'MightAdvance
type instance AdvancementOf 'Undo = 'MightAdvance
type instance AdvancementOf 'Sure = 'MightAdvance

type instance AdvancementOf 'SureStatic = 'Stationary
type instance AdvancementOf 'Static = 'Stationary

type instance AdvancementOf 'MoveUndo = 'Advances
type instance AdvancementOf 'Move = 'Advances
type instance AdvancementOf 'SureMove = 'Advances

type family FallibilityOf (p :: ActionKind) :: Fallibility

type instance FallibilityOf 'Any = 'MightFail
type instance FallibilityOf 'Undo = 'MightFail
type instance FallibilityOf 'MoveUndo = 'MightFail
type instance FallibilityOf 'Move = 'MightFail
type instance FallibilityOf 'Static = 'MightFail

type instance FallibilityOf 'SureStatic = 'AlwaysSucceeds
type instance FallibilityOf 'SureMove = 'AlwaysSucceeds
type instance FallibilityOf 'Sure = 'AlwaysSucceeds

type family CommitmentOf (p :: ActionKind) :: Commitment

type instance CommitmentOf 'Any = 'MightCommitFailure
type instance CommitmentOf 'Move = 'MightCommitFailure
type instance CommitmentOf 'Undo = 'Noncommittal
type instance CommitmentOf 'MoveUndo = 'Noncommittal
type instance CommitmentOf 'SureStatic = 'EitherCannotMoveOrCannotFail
type instance CommitmentOf 'SureMove = 'EitherCannotMoveOrCannotFail
type instance CommitmentOf 'Sure = 'EitherCannotMoveOrCannotFail
type instance CommitmentOf 'Static = 'EitherCannotMoveOrCannotFail

type family IsSequenceable (p :: Commitment) :: Bool

type instance IsSequenceable 'MightCommitFailure = 'True
type instance IsSequenceable 'Noncommittal = 'False
type instance IsSequenceable 'EitherCannotMoveOrCannotFail = 'True
